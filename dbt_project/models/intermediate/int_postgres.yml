version: 2

groups:
  - name: intermediate
    owner:
      name: taeefnajib

sources:
  - name: staging
    database: postgres
    schema: raw_staging
    tables:
      - name: stg_postgres__car_listings
        description: Staging table for car listings
        meta:
          dagster:
            asset_key: "stg_postgres__car_listings"
        # columns:
        #   - name: area
        #     description: Geographic area where the car is listed
        #     data_type: varchar
        #   - name: body_typex
        #     description: Body type of the vehicle
        #     data_type: varchar
        #   - name: brandx
        #     description: Brand/manufacturer of the vehicle
        #     data_type: varchar
        #   - name: conditionx
        #     description: Condition of the vehicle
        #     data_type: varchar
        #   - name: engine_capacityx
        #     description: Engine capacity/displacement
        #     data_type: varchar
        #   - name: fuel_typex
        #     description: Type of fuel used by the vehicle
        #     data_type: varchar
        #   - name: kilometers_runx
        #     description: Kilometers driven/mileage
        #     data_type: varchar
        #   - name: listing_title
        #     description: Title of the car listing
        #     data_type: varchar
        #   - name: modelx
        #     description: Model of the vehicle
        #     data_type: varchar
        #   - name: posted_on
        #     description: Date when the listing was posted
        #     data_type: varchar
        #   - name: price
        #     description: Listed price of the vehicle
        #     data_type: varchar
        #   - name: registration_yearx
        #     description: Year of vehicle registration
        #     data_type: double precision
        #   - name: sold_by
        #     description: Type of seller (dealer, individual, etc.)
        #     data_type: varchar
        #   - name: subarea
        #     description: Specific subarea within the main area
        #     data_type: varchar
        #   - name: transmissionx
        #     description: Transmission type of the vehicle
        #     data_type: varchar
        #   - name: url
        #     description: URL of the original listing
        #     data_type: varchar
        #   - name: views
        #     description: Number of views the listing received
        #     data_type: double precision
        #   - name: year_of_manufacturex
        #     description: Manufacturing year of the vehicle
        #     data_type: bigint
        #   - name: _dlt_load_id
        #     description: DLT load identifier
        #     data_type: varchar
        #   - name: _dlt_id
        #     description: DLT unique identifier
        #     data_type: varchar
        #   - name: trim_editionx
        #     description: Trim/edition level of the vehicle
        #     data_type: varchar

models:
  - name: int_postgres__car_listings
    description: Intermediate model for car listings with cleaned data types and calculated metrics
    columns:
      - name: _dlt_load_id
        description: DLT load identifier for tracking data lineage
        data_type: varchar
        tests:
          - not_null
      - name: _dlt_id
        description: Unique identifier for each record
        data_type: varchar
        tests:
          - unique
          - not_null
      # - name: area
      #   description: Geographic area where the car is listed
      #   data_type: varchar
      #   tests:
      #     - not_null
      # - name: subarea
      #   description: Specific subarea within the main area
      #   data_type: varchar
      # - name: brandx
      #   description: Brand/manufacturer of the vehicle
      #   data_type: varchar
      #   tests:
      #     - not_null
      # - name: modelx
      #   description: Model of the vehicle
      #   data_type: varchar
      #   tests:
      #     - not_null
      # - name: year_of_manufacturex
      #   description: Manufacturing year of the vehicle
      #   data_type: bigint
      #   tests:
      #     - not_null
      #     - dbt_utils.accepted_range:
      #         min_value: 1900
      #         max_value: 2025
      # - name: registration_yearx
      #   description: Year of vehicle registration (cleaned)
      #   data_type: int
      #   tests:
      #     - dbt_utils.accepted_range:
      #         min_value: 1900
      #         max_value: 2025
      # - name: body_typex
      #   description: Body type of the vehicle
      #   data_type: varchar
      # - name: fuel_typex
      #   description: Type of fuel used by the vehicle
      #   data_type: varchar
      # - name: transmissionx
      #   description: Transmission type of the vehicle
      #   data_type: varchar
      # - name: engine_capacityx
      #   description: Engine capacity/displacement
      #   data_type: varchar
      # - name: conditionx
      #   description: Condition of the vehicle
      #   data_type: varchar
      # - name: kilometers_runx_numeric
      #   description: Mileage converted to numeric value
      #   data_type: numeric
      #   tests:
      #     - dbt_utils.accepted_range:
      #         min_value: 0
      #         max_value: 1000000
      # - name: price_numeric
      #   description: Price converted to numeric value
      #   data_type: numeric
      #   tests:
      #     - dbt_utils.accepted_range:
      #         min_value: 0
      #         max_value: 10000000
      # - name: trim_editionx
      #   description: Trim/edition level of the vehicle
      #   data_type: varchar
      # - name: sold_by
      #   description: Type of seller
      #   data_type: varchar
      # - name: views
      #   description: Number of listing views
      #   data_type: double precision
      #   tests:
      #     - dbt_utils.accepted_range:
      #         min_value: 0
      # - name: posted_on_date
      #   description: Posting date converted to proper date format
      #   data_type: date
      # - name: listing_title
      #   description: Title of the car listing
      #   data_type: varchar
      #   tests:
      #     - not_null
      # - name: url
      #   description: URL of the original listing
      #   data_type: varchar
      #   tests:
      #     - not_null
      # - name: vehicle_age_years
      #   description: Calculated age of vehicle in years
      #   data_type: int
      #   tests:
      #     - dbt_utils.accepted_range:
      #         min_value: 0
      #         max_value: 125
      # - name: price_per_year
      #   description: Price divided by vehicle age (when age > 0)
      #   data_type: numeric
      # - name: is_recent_listing
      #   description: Boolean flag for listings posted within last 30 days
      #   data_type: boolean
      # - name: price_category
      #   description: Categorized price range (budget, mid-range, premium, luxury)
      #   data_type: varchar
      # - name: mileage_category
      #   description: Categorized mileage range (low, medium, high, very_high)
      #   data_type: varchar